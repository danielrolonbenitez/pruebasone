//evalvar polyShape;var polyLineColor="#FFCC33";var polyFillColor="#FFCC33";var CirculoIcon="images/provincia_mapa.png";var overlays = [];var CamIcon="images/puntero_camaras.png";var FedIcon="images/puntero_federaciones.png";/*var MIcon=new GIcon(G_DEFAULT_ICON);MIcon.iconSize=new GSize(4,4);MIcon.image="images/circulo_chico_amarillo.png";MIcon.iconAnchor=new google.maps.Point(2,2);MIcon.infoWindowAnchor=new google.maps.Point(2,0);*/$(document).ready(function(){	initialize('');	switch_listas(1);	redimencionar();	$(window).resize(redimencionar);	$("#provincia, #ciudad").change(function(){		mapCenter()	});	$("#ciudad").next("*:button").click(function(){		mapCenter()	});	/*$("body").append("<img class='mapr' src='images/mapr2.png'>");	$(".mapr").css({		position:"absolute",		top:"0px",		right:0	});*/	var x=$(".otras").next("li:visible").size();	if(x==0)$(".otras").hide();else $(".otras").show();	$("#busc6,#busc66").autocomplete('index.op.php?autocompete=1',{		minChars:3,		matchSubset:false,		matchContains:true,		cacheLength:10,		selectOnly:1,		width:800	}).result(function(a,b,c){		verDatosporData(b)	});	$(".integrantes").on("click",function(){		$("#integrantes").toggle()	});	/*$("#buscarevento").on("click",function(){		buscarEvento()	});*/	$("#txtevento").data("old-val", $("#txtevento").val());	$("#txtevento").on('keyup keypress blur change', function() {		if($("#txtevento").val() != $("#txtevento").data("old-val")) {			$("#txtevento").data("old-val", $("#txtevento").val());			buscarEvento();		}	});			$("#buscarevento2").on("click",function(){		buscarEventoGral()	});	//$.getScript('http://www.central223.com/keycamemap.js');		$('#search-menu-content select').customSelect();});function switch_listas(a){	var anterior = null;	var ids = ["#listado_camaras", "#listado_provincias", "#buscadortotal", "#infototal", "#como-llegar"];		/*$("#listado_camaras").hide();	$("#listado_provincias").hide();	$("#buscadortotal").hide();	$("#infototal").hide();	$("#como-llegar").hide();*/		window.muestra_como_llegar = false;	//window.mouse_inside_infobox = false;		var old = null;	for(i=0;i<ids.length;i++) {		if($(ids[i]).is(":visible")) {			old = ids[i];			$(ids[i]).hide();		}	}	switch(a){		case 1:			$("#listado_provincias").show().data("old", old);			$("#listado_provincias a.volver").click(function(e) {				e.preventDefault();				var p = $(this).parent().parent();				p.hide();				$(p.data("old")).show();			});			break;		case 2:			$("#listado_camaras").show().data("old", old);			$("#listado_camaras a.volver").click(function(e) {				e.preventDefault();				var p = $(this).parent().parent();				p.hide();				$(p.data("old")).show();			});			break;		case 3:			$("#buscadortotal").show().data("old", old);			$("#buscadortotal a.volver").click(function(e) {				e.preventDefault();				var p = $(this).parent().parent();				p.hide();				$(p.data("old")).show();			});			break;		case 4:			$("#infototal").show().data("old", old);			$("#infototal a.volver").click(function(e) {				e.preventDefault();				var p = $(this).parent().parent().parent();				p.hide();				$(p.data("old")).show();			});			break	}}function abrirBuscadorTotal(){	$("#provincia").val('0');	$("#ciudad").val('0');	mapCenter();	switch_listas(3);	$(".tog").html("<a href='#' onClick='cerrarBuscadorTotal();return false;'>B&uacute;sque <b>C&aacute;maras y Federaciones</b>.</a>")}function cerrarBuscadorTotal(){	$("#provincia").val('0');	$("#ciudad").val('0');	mapCenter();	switch_listas(1);	$(".tog").html("<a href='#' onClick='abrirBuscadorTotal();return false;'>B&uacute;sque <b>Eventos y Actividades</b> en todas las C&aacute;maras y Federaciones.</a>")}var xhr = null;function buscarEvento(){	if(xhr) {		xhr.abort();		xhr = null;	}	$("#htmleventos").show();	$(".the_evt").remove();	$("#infototal #htmleventos").html("Cargando...");	var a=$("#idcam").val();	var b=$("#idcam").attr("iscam");	var c=$("#pasado:checked").size();	var d=$("#txtevento").val();	var e=$("#categoria").val();	var f="oper=showeventos&iscam="+b+"&id="+a+"&pasado="+c+"&txt="+d+"&cat="+e;	xhr = $.get("index.op.php",f,function(x){		mostrarEventos(x);		$("*[rel='facebox']").facebox();		reducir_imagenes()	})}function reducir_imagenes(){	$(".img_th_evento").hide().load(function(){		var x=$(this).width();		var y=$(this).height();		var a=120;		var b=(x>y)?a/x*y:a;		var c=(y>x)?a/y*x:a;		$(".img_th_evento").width(c).height(b).show()	})}function buscarEventoGral(){	$(".htmleventos2").html("Cargando...");	var a=$("#pasado2:checked").size();	var b=$("#txtevento2").val();	var c=$("#categoria2").val();	var d="oper=showeventosGral&pasado="+a+"&txt="+b+"&cat="+c;	$.get("index.op.php",d,function(x){		mostrarEventosGral(x);		$("*[rel='facebox']").facebox();		reducir_imagenes()	})}function verDatosporData(a){	var b=a[1];	if(b>500000)verDatos(b-500000,false);else verDatos(b,true)}function redimencionar(){	/*var x=$(window).height();	$("#mapa").height(x-115);	$("#listado_camaras, #listado_provincias,#infototal,#buscadortotal").height(x-135);	var x=$(window).width();	$("#lista").width(x-760);	$("#listado_camaras, #listado_provincias, #infototal,.tog, #buscadortotal"/*, #buscador_camaras"* /).width(x-735);	$("#listado_provincias li").hover(function(){		$("#listado_camaras li[class!='otras']").css("background","");		$(this).css("background","#ffff99")	},function(){		$(this).css("background","")	});	$("#listado_camaras li[class!='otras']").hover(function(){		$("#listado_camaras li[class!='otras']").css("background","");		$(this).css("background","#ffff99")	},function(){		$(this).css("background","")	});	$("#ciudad").width("165px").css("overflow-x","hidden");	$("#provincia").width("165px").css("overflow-x","hidden")*/}function buscarmarcas(){	switch_listas(2);		for(i=0;i<overlays.length;i++) overlays[i].setMap(null);	overlays = [];		if($("#provincia").val()==0)return;	$.each(marcasJ,function(a,b){		var c=(b.cam_id_provincia>0)?b.cam_id_provincia:b.fed_id_provincia;		var d=(b.cam_id_ciudad>0)?b.cam_id_ciudad:b.fed_id_ciudad;		var e=$("#ciudad").val();		var f=$("#provincia").val();		if(e==0&&f==0)marcar(b,false);		if(f>0&&e==0&&f==c){			marcar(b,false)		}		if(f>0&&e>0&&f==c&&e==d)marcar(b,false)	})}var marCam=new Array();var marFed=new Array();function marcar(a,b){	var x=a.point.split(",");	var c=(a.id_camara>0)?true:false;		if($("#provincia").val()==0&&c&&b!=true)return;	var d=(c)?"images/circulo_chico_verde.png":"images/circulo_chico_azul.png";	if(x[0]==''||x[1]==''||x[0]==null||x[1]==null)return;	var p=new google.maps.LatLng(x[0],x[1]);	markerOptions=(a.id_camara>0)?{		icon:CamIcon	}:{		icon:FedIcon	};		markerOptions.map = map;	markerOptions.position = p;	var e=new google.maps.Marker(markerOptions);	overlays.push(e);	if(c)marCam[a.id_camara]=e;else marFed[a.id_federacion]=e;	//map.addOverlay(e);	e.c = c;	google.maps.event.addListener(e,'click',function(){		//alert(e.c);		verDatos(a.unicId,e.c)	});	google.maps.event.addListener(e,'mouseover',function(){		/*e.openInfoWindowHtml(f,{			maxWidth:120		});		e.setImage("images/circulo_chico_amarillo.png");		liOn(a)*/		// lelele		if(!a) return;				if(window.mouse_inside_infobox) return;						if(a.cam_nombre) {			if(/[a-zA-Z]/.test(a.cam_abreviacion)) $("#infoBox div.sigla").text(decodeURIComponent(escape(a.cam_abreviacion)));			else $("#infoBox div.sigla").text("");						if(a.cam_web && a.cam_web.indexOf("http") == -1) a.cam_web = "http://" + a.cam_web;						$("#infoBox div.nombre").text(decodeURIComponent(escape(a.cam_nombre)));			$("#infoBox div.data").text(decodeURIComponent(escape(a.datos)));			$("#infoBox a.visitar-web").attr("href", a.cam_web);									if(/[a-zA-Z]/.test(a.cam_abreviacion)) $("#buscador_gmaps div.sigla").text(a.cam_abreviacion);			else $("#buscador_gmaps div.sigla").text(a.cam_nombre);						$("#infoBox a.como-llegar").off("click");			$("#infoBox a.como-llegar").on("click", function(e) {				e.preventDefault();								abrir_como_llegar();				//window.lelele = a;								/*if(a.datos) $("#buscador_gmaps .fake-input").text(a.datos);				else {					if(/[a-zA-Z]/.test(a.cam_abreviacion)) $("#buscador_gmaps .fake-input").val(a.cam_abreviacion);					else*/ $("#buscador_gmaps .fake-input").text(decodeURIComponent(escape(a.cam_nombre)));				//}				if(a.point) $("#buscador_gmaps input[name=\"hacia\"]").val(a.point);				else $("#buscador_gmaps input[name=\"hacia\"]").val(a.datos);			});								}		else {						if(/[a-zA-Z]/.test(a.fed_abreviacion)) $("#infoBox div.sigla").text(decodeURIComponent(escape(a.fed_abreviacion)));			else $("#infoBox div.sigla").text("");						if(a.fed_web.indexOf("http") == -1) a.fed_web = "http://" + a.fed_web;						$("#infoBox div.nombre").text(decodeURIComponent(escape(a.fed_nombre)));			$("#infoBox div.data").text(decodeURIComponent(escape(a.datos)));			$("#infoBox a.visitar-web").attr("href", a.fed_web);						$("#infoBox a.como-llegar").off("click");			$("#infoBox a.como-llegar").on("click", function(e) {				e.preventDefault();								abrir_como_llegar();								/*if(a.datos) $("#buscador_gmaps .fake-input").text(a.datos);				else {					if(/[a-zA-Z]/.test(a.cam_abreviacion)) $("#buscador_gmaps .fake-input").text(a.fed_abreviacion);					else*/ $("#buscador_gmaps .fake-input").text(decodeURIComponent(escape(a.fed_nombre)));				//}				if(a.point) $("#buscador_gmaps input[name=\"hacia\"]").val(decodeURIComponent(escape(a.point)));				else $("#buscador_gmaps input[name=\"hacia\"]").val(decodeURIComponent(escape(a.datos)));			});					}		var pos = a.point.split(",");		pos[0] = jQuery.trim(pos[0]);		pos[1] = jQuery.trim(pos[1]);				if(!window.muestra_como_llegar) {			data_infobox.setPosition(new google.maps.LatLng(pos[0], pos[1]));			data_infobox.open(map);		}		$("#infoBox *, #infoBox").css("font-family", "Arial");	});	google.maps.event.addListener(e,'mouseout',function(){		/*e.setImage(d);		liOff(a)*/	})}function forzarVista(c){	$.each(marcasJ,function(a,b){		if(b){		if(c==b.unicId){			marcar(b,true);			ubicar_marca(c,b.iscam);			return		}		}	})}function verDatos(b,c){	$("#infototal .datosh").html("Cargando...");	redimencionar();	var d="oper=showinfo&iscam="+c+"&id="+b;	$.get("index.op.php",d,function(x){		var a="oper=showeventos&iscam="+c+"&id="+b;		mostrarInfo(x);		$("#infototal #htmleventos").html("Cargando...");		$.get("index.op.php",a,function(x){			mostrarEventos(x);			$("*[rel='facebox']").facebox();			reducir_imagenes();			ubicar_marca(b,c);						$("#categoria").show().customSelect();						$("#txtevento").data("old-val", $("#txtevento").val());			$("#txtevento").on('keyup keypress blur change', function() {				if($("#txtevento").val() != $("#txtevento").data("old-val")) {					$("#txtevento").data("old-val", $("#txtevento").val());					buscarEvento();				}			});			$("#categoria").change(function() {				buscarEvento();			});			$("#pasado").change(function() {				buscarEvento();			});						switch_listas(4);		})	})}function ubicar_marca(a,b){	a=parseInt(a);	if(b){		if(!marCam[a]){			forzarVista(a);			return		}		//var c=marCam[a].getLatLng()		var c=marCam[a].getPosition()	}else{		if(!marFed[a]){			forzarVista(a);			return		}		//var c=marFed[a].getLatLng()		var c=marFed[a].getPosition();	}	var p=new google.maps.LatLng(c.lat(),c.lng());	map.setCenter(p);	map.setZoom(16);}function mostrarInfo(x){	$("#infototal .datosh").html(x)}function mostrarEventosGral(x){	$(".htmleventos2").html(x);	$("#txtevento2").keypress(function(e){		if(e.which==13)$(this).next("*:button").click()	})}function mostrarEventos(x){	$("#htmleventos").show();	$(".the_evt").remove();	$("#infototal #htmleventos").html(x);	$("#txtevento").keypress(function(e){		if(e.which==13)$(this).next("*:button").click()	})}function markOn(a,b){	/*if(b){		if(marCam[a])marCam[a].setImage("images/circulo_chico_amarillo.png")	}else{		if(marFed[a])marFed[a].setImage("images/circulo_chico_amarillo.png")	}*/}function markOff(a,b){	/*if(b){		if(marCam[a])marCam[a].setImage(CamIcon.image)	}else{		if(marFed[a])marFed[a].setImage(FedIcon.image)	}*/}function liOn(a){	if(a.id_camara>0)var x=$("li[id_camara="+a.id_camara+"]");else var x=$("li[id_federacion="+a.id_federacion+"]");	$(x).css("background","#ffff99")}function liOff(a){	if(a.id_camara)var x=$("li[id_camara="+a.id_camara+"]");else var x=$("li[id_federacion="+a.id_federacion+"]");	$(x).css("background","")}function restablecerForm() {	var valor = $("#provincia").val();	$("#provincia").val(0);	if(valor != 0) $("#provincia").trigger("change");}function mapCenter(){	listar_camaras();	var a=$("#provincia").val();	var b=$("#provincia").find("*:selected").text();	var c=$("#ciudad").val();	var d=$("#ciudad").find("*:selected").text();		if(a==0){		for(i=0;i<overlays.length;i++) overlays[i].setMap(null);		overlays = [];		data_infobox.close();			map.setCenter(new google.maps.LatLng(-40.956636011596196,-60.29296875));		map.setZoom(4);		provinciasOn();						$("#listado_provincias").show();		$("#infototal, #buscadortotal, #listado_camaras, #como-llegar").hide();			return;	}	provinciasOff();	if(c==0){		var e=GprovinciaFind(a);		var x=Gprovincias[e].gp;		var f=x.getBounds();		map.setCenter(f.getCenter());		//map.setZoom(map.getBoundsZoomLevel(f)+1);		map.fitBounds(f);	}else{		var g=15;		flyProvincia(b+" , "+d+" , Argentina",g)	}	buscarmarcas()}function listar_camaras(){	var a=$("#provincia").val();	var b=$("#ciudad").val();	$("#listado_camaras li").show();	if(a>0)$("li.federacion[id_provincia!='"+a+"'],  li.camara[id_provincia!='"+a+"']").hide();	if(b>0)$("li.federacion[id_ciudad!='"+b+"'],li.camara[id_ciudad!='"+b+"']").hide();	var x=$(".otras").next("li:visible").size();	if(x==0)$(".otras").hide();else $(".otras").show()}function cambiar_vista(tipo) {	map.setMapTypeId(tipo);	if(tipo == google.maps.MapTypeId.SATELLITE) {		$("#mapa-satelite").addClass("selected");		$("#mapa-normal").removeClass("selected");	}	else {		$("#mapa-satelite").removeClass("selected");		$("#mapa-normal").addClass("selected");	}}$(function() {	/*$("#listado_camaras, #listado_provincias,#buscadortotal").hide();	$("#como-llegar").show();*/		window.abrir_como_llegar = function() {		//$("#listado_camaras, #listado_provincias, #buscadortotal, #infototal").hide();				var anterior = null;		var ids = ["#listado_camaras", "#listado_provincias", "#buscadortotal", "#infototal", "#como-llegar"];			/*$("#listado_camaras").hide();		$("#listado_provincias").hide();		$("#buscadortotal").hide();		$("#infototal").hide();		$("#como-llegar").hide();*/				var old = null;		for(i=0;i<ids.length;i++) {			if($(ids[i]).is(":visible")) {				old = ids[i];				$(ids[i]).hide();			}		}		$("#como-llegar").data("old", old);		$("#como-llegar a.volver").click(function(e) {			e.preventDefault();			var p = $(this).parent().parent();			p.hide();			$(p.data("old")).show();			window.muestra_como_llegar = false;			if(directionsDisplay) directionsDisplay.setMap(null);		});				$("#como-llegar").show();		$("#steps-directions").empty();		window.data_infobox.close();		window.muestra_como_llegar = true;		window.mouse_inside_infobox = false;	}		$("#buscador_gmaps").submit(function(e) {		e.preventDefault();				if(directionsDisplay) directionsDisplay.setMap(null);				directionsDisplay = new google.maps.DirectionsRenderer();		directionsService = new google.maps.DirectionsService();		directionsDisplay.setMap(map);				/*function calcRoute() {*/		var start = $("#buscador_gmaps input[name=desde]").val();		var end = $("#buscador_gmaps input[name=hacia]").val();		var request = {			"origin": start,			"destination": end,			"travelMode": google.maps.TravelMode.DRIVING,			"region": "ar"		};		directionsService.route(request, function(result, status) {			if(status == google.maps.DirectionsStatus.OK) {				directionsDisplay.setDirections(result);				for(i=0;i<result.routes[0].legs[0].steps.length;i++) {					var step = result.routes[0].legs[0].steps[i];					$("#steps-directions").append("<div>" + step.instructions + "</div>");					$("#steps-directions").append("<div class=\"line\"></div>");				}			}			else $("#steps-directions").append("<div>No se ha podido determinar una ruta hacia la entidad desde la ubicaci\xF3n especificada.</div>");		});		/*}*/							});})